---
title: "Reproducibility workshop"
author: "Eirini Zormpa"
output: html_document
---

# Set up

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages}
# install.packages("readr")
# install.packages("janitor")
# install.packages("tidyr")
# install.packages("dplyr")
# install.packages("magrittr")
# install.packages("forcats")
# install.packages("ggplot2")

# to read in data as tibbles
library(readr)
# for easy data (in this case name) cleaning
library(janitor)
# for tidying data
library(tidyr)
# for wranglingdata
library(dplyr)
# for pipes
library(magrittr)
# for all your factor needs
library(forcats)
# for beautiful plots
library(ggplot2)
```

In this workshop we'll go through some basics on how to create, structure, and document reproducible projects in R.
We will then create an online version of that project that everyone can interact with *without having to download anything*.

For this workshop, we'll be using data from the World Happiness Reports (years 2015-2019), a survey used to rank the happiness of people in the participating countries.
The data come from [kaggle](https://www.kaggle.com/) and you can find the entry for this particular dataset [here](https://www.kaggle.com/unsdsn/world-happiness).

# Read data
Before we do anything, we need to get some data into R.
You can see below my feeble attempt to read in the data from 2019.
I mean... it works (you can try it), but my computer is in danger!

```{r read_data_bad}
setwd("C:/Users/eirin/Documents/MPI Psycholinguistics/Teaching/IMPRS_Conf2020")
ds <- read_csv("world-happiness/2019.csv")
```

We can do better than this!

```{r read_data_good}
# read in the data using a relative path
# if you ran the code above feel free to use 'ds' when reimporting the data

```

Hint: you might want to use the 'here' package to create the relative paths.


Now that we got our data into R, let's see what it looks like!

```{r glimpse_data}
# glimpse is a function from the dplyr package that gives you a, well, glimpse of your tibbles.
glimpse(ds)
```

Before we go any further, we need to deal with these names.
Spaces are generally not allowed in column names in R (here R is forced to accept them by using the backticks ``).
A really handy way to do this is by using the 'janitor' package.

```{r clean_names}
ds = janitor::clean_names(ds)
```

Let's take a look at what this has done:

```{r check_names}
glimpse(ds)
```

Okay, that looks much better!

Let's explore our data a little bit.
I'm from Greece and was curious to see how Greece ranks in this survey.

```{r greece_happiness}
ds %>% filter(country_or_region == "Greece")
```

Feel free to explore these data a little bit too!
```{r }
# pick a country (whichever country) and see where it ranks
# head on over to mentimeter and tell us what rank you got!

```

Let's play around with plots a little bit

```{r rank_lollipop}
ds %>%
  filter(overall_rank <= 10) %>%
  arrange(desc(overall_rank)) %>%
  mutate(country_or_region = factor(country_or_region, levels = country_or_region)) %>%
  ggplot(aes(x=country_or_region, y=score)) +
  geom_point(size = 4, colour = "orange") + 
  geom_segment( aes(x=country_or_region, xend=country_or_region, y=6.5, yend=score)) +
  coord_flip() +
  theme_bw() +
  xlab("")
```

```{r}
fct_reorder(ds$score, overall_rank)
```

